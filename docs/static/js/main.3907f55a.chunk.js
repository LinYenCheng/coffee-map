(this["webpackJsonpreact-leaflet-map"]=this["webpackJsonpreact-leaflet-map"]||[]).push([[0],{63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(13),i=n(23),r=n(21),o=n(47),s=n(50),l=n(16),u=n(12),d=n(11),h=n.n(d),j=n(17),p=n(34),b=n(35),f=n(33),O=n(36),m=n(48),g=n.n(m),x=n(1);function v(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}var y=function(e){return Object(x.jsx)(p.a,Object(j.a)({ref:function(e){e&&e.leafletElement.openPopup()}},e))};var k=function(e){var t=e.position,n=e.isMenuOpen,c=e.toggleMenu,a=e.item,i=e.items,r=a.latitude,o=a.longitude,s=a.url,l=a.name,u=a.address,d=a.wifi,h=a.seat,j=a.quiet,m=a.tasty,k=a.cheap,N=a.music,w=[parseFloat(r),parseFloat(o)],_=!!s,C=null,E=i.filter((function(e){return e.lat})).map((function(e,t){return Object(x.jsx)(p.a,{opacity:.6,position:[parseFloat(e.lat),parseFloat(e.lng)],children:Object(x.jsx)(b.a,{children:Object(x.jsx)("div",{dangerouslySetInnerHTML:{__html:e.popup}})})},"".concat(e.lat).concat(e.lng).concat(t))}));return r&&(C=Object(x.jsx)("button",{type:"button",children:Object(x.jsx)(y,{position:w,children:Object(x.jsx)(b.a,{autoPan:!0,children:Object(x.jsxs)("div",{children:[Object(x.jsx)("span",{style:{fontWeight:800,fontSize:"16px"},children:l}),Object(x.jsx)("br",{}),Object(x.jsxs)("span",{children:[u,Object(x.jsx)("br",{}),d>0?"WIFI\u7a69\u5b9a: ".concat(v(d)," "):" ",d>0?Object(x.jsx)("br",{}):"",h>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(v(h)," "):" ",h>0?Object(x.jsx)("br",{}):"",j>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(v(j)," "):" ",j>0?Object(x.jsx)("br",{}):"",m>0?"\u5496\u5561\u597d\u559d:  ".concat(v(m)," "):" ",m>0?Object(x.jsx)("br",{}):"",k>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(v(k)," "):" ",k>0?Object(x.jsx)("br",{}):"",N>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(v(N)," "):" ",N>0?Object(x.jsx)("br",{}):""]}),_?Object(x.jsx)("a",{href:s,children:"\u7c89\u7d72\u5c08\u9801"}):""]})})})})),Object(x.jsxs)(f.a,{center:t,zoom:12,maxZoom:18,zoomControl:!1,animate:!0,onClick:function(){n&&c()},children:[Object(x.jsx)(O.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r&&C,Object(x.jsx)(g.a,{children:E})]})},N=(n(63),function(e){var t=e.toggleMenu;return Object(x.jsx)("button",{type:"button",id:"menu-button",onClick:function(e){var n=t;e.preventDefault(),n()},children:Object(x.jsx)("div",{className:"hamburger",children:Object(x.jsx)("div",{className:"inner"})})})}),w=(n(64),function(e){return{type:"TOGGLE_CONDITION",payload:e}}),_=[{name:"taipei",displayName:"\u53f0\u5317",lng:121.5598,lat:25.08,checked:!0},{name:"keelung",displayName:"\u57fa\u9686",lng:121.7081,lat:25.10898,checked:!1},{name:"taoyuan",displayName:"\u6843\u5712",lng:121.300974,lat:24.993312,checked:!1},{name:"hsinchu",displayName:"\u65b0\u7af9",lng:120.9647,lat:24.80395,checked:!1},{name:"miaoli",displayName:"\u82d7\u6817",lng:120.820793,lat:24.565031,checked:!1},{name:"taichung",displayName:"\u53f0\u4e2d",lng:120.645756,lat:24.176912,checked:!1},{name:"changhua",displayName:"\u5f70\u5316",lng:120.4818,lat:23.99297,checked:!1},{name:"nantou",displayName:"\u5357\u6295",lng:120.9876,lat:23.83876,checked:!1},{name:"yunlin",displayName:"\u96f2\u6797",lng:120.3897,lat:23.75585,checked:!1},{name:"chiayi",displayName:"\u5609\u7fa9",lng:120.574,lat:23.45889,checked:!1},{name:"tainan",displayName:"\u53f0\u5357",lng:120.1851,lat:23.005181,checked:!1},{name:"kaohsiung",displayName:"\u9ad8\u96c4",lng:120.312019,lat:22.623045,checked:!1},{name:"pingtung",displayName:"\u5c4f\u6771",lng:120.62,lat:22.54951,checked:!1},{name:"yilan",displayName:"\u5b9c\u862d",lng:121.7195,lat:24.69295,checked:!1},{name:"hualien",displayName:"\u82b1\u84ee",lng:121.3542,lat:23.7569,checked:!1},{name:"taitung",displayName:"\u53f0\u6771",lng:120.9876,lat:22.98461,checked:!1},{name:"penghu",displayName:"\u6f8e\u6e56",lng:119.6151,lat:23.56548,checked:!1}],C=[{name:"socket",displayName:"\u63d2\u5ea7",checked:!1},{name:"quiet",displayName:"\u5b89\u975c",checked:!1},{name:"wifi",displayName:"\u7db2\u8def",checked:!1}];var E=Object(r.b)((function(e){return{checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}))((function(e){var t=e.setPosition,n=e.checkedCities,c=e.checkedConditions,a=e.dispatch,i=e.toggleMenu,r=_.map((function(e,c){return Object(x.jsxs)("li",{className:"nav__li",children:[Object(x.jsx)("input",{id:e.name,type:"checkbox",checked:n[c],onChange:function(){var r=n.slice();r[c]=!n[c],n[c]||t([e.lat,e.lng]),a(function(e){return{type:"TOGGLE_CHECK",payload:e}}(r)),i()}}),Object(x.jsx)("label",{htmlFor:e.name,className:"nav__label",children:e.displayName})]},e.name)})),o=C.map((function(e,t){return Object(x.jsxs)("li",{className:"nav__li",children:[Object(x.jsx)("input",{id:e.name,type:"checkbox",checked:c[t],onChange:function(){var e=c.slice();e[t]=!c[t],a(w(e)),i()}}),Object(x.jsx)("label",{htmlFor:e.name,className:"nav__label nav__label--condition",children:e.displayName})]},e.name)}));return Object(x.jsx)("nav",{children:Object(x.jsxs)("ul",{children:[o,Object(x.jsx)("br",{}),r]})})})),S=(n(65),n(49)),M=n.n(S),L=(0,window.lunr)((function(){this.field("name"),this.field("address"),this.field("strSocket"),this.field("quietAways"),this.field("wifiGood")})),T=_.map((function(e){return e.coffeeShops?e:Object(j.a)(Object(j.a)({},e),{},{coffeeShops:[]})})),G=function(){var e=Object(l.a)(h.a.mark((function e(t){var n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(j.a)({},t),e.next=3,M.a.get("".concat("/coffee-map","/cafedata/").concat(n.name,".json"));case 3:if(!(c=e.sent).data){e.next=9;break}return c.data.forEach((function(e){L.add(Object(j.a)(Object(j.a)({},e),{},{strSocket:e&&"yes"===e.socket?"\u63d2\u5ea7":"",quietAways:e&&e.quiet>3?"\u5b89\u975c":"",wifiGood:e&&e.wifi>3?"\u7db2\u8def":""}))})),n.coffeeShops=c.data,n.checked=!0,e.abrupt("return",n);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function I(){return(I=Object(l.a)(h.a.mark((function e(t){var n,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e,t){return e&&!T[t].coffeeShops.length?G(T[t]):(e||(T[t].checked=!1),e&&(T[t].checked=!0),T[t])})));case 2:return n=e.sent,c=[],n.forEach((function(e){e.checked&&(c=c.concat(e.coffeeShops))})),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(l.a)(h.a.mark((function e(t){var n,c,a,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],""===t.toString().trim()){e.next=6;break}return e.next=4,L.search(t);case 4:(c=e.sent)&&c.length&&(a=c.map((function(e){return e.ref})),i=[],T.filter((function(e){return e.checked})).forEach((function(e){i=i.concat(e.coffeeShops)})),i=i.filter((function(e){return-1!==a.indexOf(e.id)})),n=i);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P={getCoffee:function(e){return I.apply(this,arguments)},searchWithKeyWord:function(e){return F.apply(this,arguments)}},D=P;var q=function(e){var t=e.onHover,n=e.checkedConditions,a=e.nowItem,i=e.toggleCondition,r="",o=Object(c.useRef)(null),s=Object(c.useState)(1),d=Object(u.a)(s,2),j=d[0],p=d[1],b=Object(c.useState)([]),f=Object(u.a)(b,2),O=f[0],m=f[1],g=Object(c.useState)([]),v=Object(u.a)(g,2),y=v[0],k=v[1],N=Object(c.useState)(""),w=Object(u.a)(N,2),_=w[0],E=w[1],S=C.filter((function(e,t){return n[t]})).map((function(e){return e.displayName})).join(" "),M=Object(c.useCallback)(function(){var e=Object(l.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),e.next=3,D.searchWithKeyWord("".concat(S," ").concat(_));case 3:n=e.sent,m(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[S,_]);function L(e){e&&a&&e.id!==a.id&&(t(e),o.current.blur())}Object(c.useEffect)((function(){""===_&&M()}),[_,M]),Object(c.useEffect)((function(){""!==S&&M()}),[S,M]),Object(c.useEffect)((function(){O.length&&k(O.slice(0,10*j))}),[O,j]),y.length&&(r=y.map((function(e){return Object(x.jsxs)("div",{role:"presentation",className:"card",onClick:function(){L(e),o.current.blur()},onFocus:function(){L(e)},onTouchMove:function(){L(e)},children:[Object(x.jsx)("h4",{children:e.name}),Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{children:Object(x.jsxs)("ol",{children:["no"===e.limited_time?Object(x.jsx)("li",{children:"\u7121\u9650\u6642"}):"",""!==e.socket||"no"!==e.socket?Object(x.jsx)("li",{children:"\u63d2\u5ea7"}):"",e.wifi>3?Object(x.jsx)("li",{children:"WIFI"}):"",e.quiet>3?Object(x.jsx)("li",{children:"\u8f03\u5b89\u975c"}):"",e.cheap>3?Object(x.jsx)("li",{children:"\u8f03\u4fbf\u5b9c"}):""]})}),Object(x.jsx)("li",{children:"\u5730\u5740:".concat(e.address)}),e.open_time?Object(x.jsx)("li",{children:"\u71df\u696d\u6642\u9593: ".concat(e.open_time)}):"",Object(x.jsx)("li",{children:Object(x.jsx)("a",{href:e.url,children:"\u7c89\u7d72\u5c08\u9801"})})]})]},e.id)})));var T="\u8f38\u5165\u5e97\u540d \u5730\u5740";S&&(T="\u67e5\u8a62\u689d\u4ef6:".concat(S));var G=Object(x.jsx)("button",{type:"submit",className:"btn search__button",onClick:M,children:Object(x.jsxs)("svg",{viewBox:"0 0 100 100",children:[Object(x.jsx)("circle",{id:"circle",cx:"45",cy:"45",r:"30"}),Object(x.jsx)("path",{id:"line",d:"M45,45 L100,100"})]})});return""===_&&""===S||(G=Object(x.jsx)("button",{type:"button",className:"btn search__button",onClick:function(){i(),E(""),k([])},children:Object(x.jsx)("span",{children:"\u2715"})})),Object(x.jsxs)("form",{onSubmit:M,children:[Object(x.jsx)("input",{value:_,onChange:function(e){E(e.target.value)},ref:o,onClick:function(){M()},onKeyPress:function(e){"Enter"===e.key&&o.current.blur()},placeholder:"".concat(T)}),Object(x.jsx)("div",{className:"search__result",onScroll:function(e){e.target.scrollTop>e.target.clientHeight*j&&O.length>10*j&&p(j+1)},children:r}),G]})};function W(e){var t=e.isMenuOpen,n=e.checkedCities,a=e.checkedConditions,i=e.toggleMenu,r=e.toggleCondition,o=Object(c.useState)({name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"}),s=Object(u.a)(o,2),d=s[0],j=s[1],p=Object(c.useState)({lng:121.5598,lat:25.08}),b=Object(u.a)(p,2),f=b[0],O=b[1],m=Object(c.useState)([]),g=Object(u.a)(m,2),v=g[0],y=g[1],w=Object(c.useState)(!0),_=Object(u.a)(w,2),C=_[0],S=_[1],M=d,L=v,T=t?"menu-open":"",G="";function I(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}function F(){return(F=Object(l.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),console.log("loading"),e.next=4,D.getCoffee(t);case 4:n=e.sent,console.log("loading done"),S(!1),y(n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){!function(e){F.apply(this,arguments)}(n)}),[n]),L=0===v.length?[{lat:24.8,lng:121.023,popup:"<div><span>\u76ee\u524d\u5c1a\u672a\u9078\u64c7\u4efb\u4f55\u5730\u9ede<br/>\u8acb\u6309\u5de6\u65b9\u529f\u80fd\u9375\u9032\u5165\u9078\u55ae\u9078\u64c7XD<br/></span></div>"}]:v.map((function(e){var t=e.latitude,n=e.longitude,c=e.name,a=e.address,i=e.wifi,r=e.seat,o=e.quiet,s=e.tasty,l=e.cheap,u=e.music;return{lat:parseFloat(t),lng:parseFloat(n),popup:"<div>\n            <span style=".concat({fontWeight:800,fontSize:"16px"},">").concat(c,"</span><br /> \n            <span>\n            ").concat(a,"<br />\n            ").concat(i>0?"WIFI\u7a69\u5b9a: ".concat(I(i)):""," ").concat(i>0?"<br />":"","\n            ").concat(r>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(I(r)):""," ").concat(r>0?"<br />":"","\n            ").concat(o>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(I(o)):""," ").concat(o>0?"<br />":"","\n            ").concat(s>0?"\u5496\u5561\u597d\u559d:  ".concat(I(s)):""," ").concat(s>0?"<br />":"","\n            ").concat(l>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(I(l)):""," ").concat(l>0?"<br />":"","\n            ").concat(u>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(I(u)):""," ").concat(u>0?"<br />":"","\n            </span>\n            ").concat(d.url?"<a href=".concat(d.url,">\u7c89\u7d72\u5c08\u9801</a>"):"","\n          </div>")}})),C&&(G=Object(x.jsx)("div",{className:"loading__overlay",children:Object(x.jsx)("div",{className:"loading__content",children:Object(x.jsx)("div",{className:"loader",children:"Loading..."})})})),Object(x.jsxs)("div",{className:"app",children:[G,Object(x.jsxs)("div",{className:T,children:[Object(x.jsx)("div",{className:"search-container",children:Object(x.jsx)(q,{nowItem:d,toggleCondition:r,checkedConditions:a,onChange:function(e){d&&e&&d.id!==e.id&&j(e),r()},onHover:function(e){d&&e&&d.id!==e.id&&j(e)}})}),Object(x.jsx)(E,{toggleMenu:i,setPosition:O}),Object(x.jsx)(N,{toggleMenu:i})]}),Object(x.jsx)(k,{position:f,item:M,items:L,isMenuOpen:t,toggleMenu:i})]})}W.defaultProps={name:"Gary"};var A=Object(r.b)((function(e){return{isMenuOpen:e.isMenuOpen,checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}),(function(e){return{toggleCondition:function(){return e(w())},toggleMenu:function(){return e({type:"TOGGLE_MENU"})}}}))(W),H=(n(84),function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"TOGGLE_MENU"===t.type?!e:e}),z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"},t=arguments.length>1?arguments[1]:void 0;return"SELECT_PLACE"===t.type?{name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~1",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"}:e},K=n(22),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"ALL_PLACE"===t.type?Object(K.a)(e):e},X=_.map((function(e){return e.checked})),B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;if("TOGGLE_CHECK"===t.type){var n=Object(K.a)(t.payload);return n}return e},R=C.map((function(e){return e.checked})),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;if("TOGGLE_CONDITION"===t.type){var n=t.payload?Object(K.a)(t.payload):R;return n}return e},V=Object(i.b)({checkedCities:B,checkedConditions:J,isMenuOpen:H,item:z,items:U}),Z=(Object(o.createLogger)(),[s.a]),Q=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):i.c)(i.a.apply(void 0,Z)),Y=Object(i.d)(V,Q);Object(a.render)(Object(x.jsx)(r.a,{store:Y,children:Object(x.jsx)(A,{})}),document.getElementById("root"));var $,ee,te,ne,ce,ae,ie="linyencheng.github.io";if(window.location.host===ie&&($=window,ee=document,te="script",ne="ga",$.GoogleAnalyticsObject=ne,$.ga=$.ga||function(){($.ga.q=$.ga.q||[]).push(arguments)},$.ga.l=1*new Date,ce=ee.createElement(te),ae=ee.getElementsByTagName(te)[0],ce.async=1,ce.src="//www.google-analytics.com/analytics.js",ae.parentNode.insertBefore(ce,ae),window.ga)){var re=window.ga;re("create","UA-106834789-1",ie),re("send","pageview")}}},[[85,1,2]]]);
//# sourceMappingURL=main.3907f55a.chunk.js.map