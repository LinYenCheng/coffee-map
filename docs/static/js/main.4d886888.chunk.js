(this["webpackJsonpreact-leaflet-map"]=this["webpackJsonpreact-leaflet-map"]||[]).push([[0],{46:function(e,t,a){e.exports=a(84)},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),l=a(12),r=a(20),o=a(19),i=a(42),s=a(43),u=a(10),m=a.n(u),d=a(15),p=a(11),h=a(29),f=a(30),g=a(28),E=a(31),b=a(44),y=a.n(b);function k(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}const O=e=>c.a.createElement(h.a,Object.assign({ref:e=>{e&&e.leafletElement.openPopup()}},e));var v=function({position:e,isMenuOpen:t,toggleMenu:a,item:n,items:l}){const r=n.latitude,o=n.longitude,i=n.url,s=n.name,u=n.address,m=n.wifi,d=n.seat,p=n.quiet,b=n.tasty,v=n.cheap,w=n.music,N=[parseFloat(r),parseFloat(o)],_=!!i;let C=null;const j=l.filter(e=>e.lat).map((e,t)=>c.a.createElement(h.a,{key:"".concat(e.lat).concat(e.lng).concat(t),opacity:.6,position:[parseFloat(e.lat),parseFloat(e.lng)]},c.a.createElement(f.a,null,c.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.popup}}))));return r&&(C=c.a.createElement("button",{type:"button"},c.a.createElement(O,{position:N},c.a.createElement(f.a,{autoPan:!0},c.a.createElement("div",null,c.a.createElement("span",{style:{fontWeight:800,fontSize:"16px"}},s),c.a.createElement("br",null),c.a.createElement("span",null,u,c.a.createElement("br",null),m>0?"WIFI\u7a69\u5b9a: ".concat(k(m)," "):" ",m>0?c.a.createElement("br",null):"",d>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(k(d)," "):" ",d>0?c.a.createElement("br",null):"",p>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(k(p)," "):" ",p>0?c.a.createElement("br",null):"",b>0?"\u5496\u5561\u597d\u559d:  ".concat(k(b)," "):" ",b>0?c.a.createElement("br",null):"",v>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(k(v)," "):" ",v>0?c.a.createElement("br",null):"",w>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(k(w)," "):" ",w>0?c.a.createElement("br",null):""),_?c.a.createElement("a",{href:i},"\u7c89\u7d72\u5c08\u9801"):""))))),c.a.createElement(g.a,{center:e,zoom:12,maxZoom:18,zoomControl:!1,animate:!0,onClick:()=>{t&&a()}},c.a.createElement(E.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r&&C,c.a.createElement(y.a,null,j))};a(61);var w=e=>c.a.createElement("button",{type:"button",id:"menu-button",onClick:t=>{const a=e.toggleMenu;t.preventDefault(),a()}},c.a.createElement("div",{className:"hamburger"},c.a.createElement("div",{className:"inner"})));a(62);const N=e=>({type:"TOGGLE_CONDITION",payload:e}),_=[{name:"taipei",displayName:"\u53f0\u5317",lng:121.5598,lat:25.08,checked:!0},{name:"keelung",displayName:"\u57fa\u9686",lng:121.7081,lat:25.10898,checked:!1},{name:"taoyuan",displayName:"\u6843\u5712",lng:121.300974,lat:24.993312,checked:!1},{name:"hsinchu",displayName:"\u65b0\u7af9",lng:120.9647,lat:24.80395,checked:!1},{name:"miaoli",displayName:"\u82d7\u6817",lng:120.820793,lat:24.565031,checked:!1},{name:"taichung",displayName:"\u53f0\u4e2d",lng:120.645756,lat:24.176912,checked:!1},{name:"changhua",displayName:"\u5f70\u5316",lng:120.4818,lat:23.99297,checked:!1},{name:"nantou",displayName:"\u5357\u6295",lng:120.9876,lat:23.83876,checked:!1},{name:"yunlin",displayName:"\u96f2\u6797",lng:120.3897,lat:23.75585,checked:!1},{name:"chiayi",displayName:"\u5609\u7fa9",lng:120.574,lat:23.45889,checked:!1},{name:"tainan",displayName:"\u53f0\u5357",lng:120.1851,lat:23.005181,checked:!1},{name:"kaohsiung",displayName:"\u9ad8\u96c4",lng:120.312019,lat:22.623045,checked:!1},{name:"pingtung",displayName:"\u5c4f\u6771",lng:120.62,lat:22.54951,checked:!1},{name:"yilan",displayName:"\u5b9c\u862d",lng:121.7195,lat:24.69295,checked:!1},{name:"hualien",displayName:"\u82b1\u84ee",lng:121.3542,lat:23.7569,checked:!1},{name:"taitung",displayName:"\u53f0\u6771",lng:120.9876,lat:22.98461,checked:!1},{name:"penghu",displayName:"\u6f8e\u6e56",lng:119.6151,lat:23.56548,checked:!1}],C=[{name:"socket",displayName:"\u63d2\u5ea7",checked:!1},{name:"quiet",displayName:"\u5b89\u975c",checked:!1},{name:"wifi",displayName:"\u7db2\u8def",checked:!1}];var j=Object(o.b)((function(e){return{checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}))((function({setPosition:e,checkedCities:t,checkedConditions:a,dispatch:n,toggleMenu:l}){const r=_.map((a,r)=>c.a.createElement("li",{className:"nav__li",key:a.name},c.a.createElement("input",{id:a.name,type:"checkbox",checked:t[r],onChange:()=>{const c=t.slice();c[r]=!t[r],t[r]||e([a.lat,a.lng]),n((e=>({type:"TOGGLE_CHECK",payload:e}))(c)),l()}}),c.a.createElement("label",{htmlFor:a.name,className:"nav__label"},a.displayName))),o=C.map((e,t)=>c.a.createElement("li",{className:"nav__li",key:e.name},c.a.createElement("input",{id:e.name,type:"checkbox",checked:a[t],onChange:()=>{const e=a.slice();e[t]=!a[t],n(N(e)),l()}}),c.a.createElement("label",{htmlFor:e.name,className:"nav__label nav__label--condition"},e.displayName)));return c.a.createElement("nav",null,c.a.createElement("ul",null,o,c.a.createElement("br",null),r))})),S=(a(63),a(26)),x=a(45),M=a.n(x);const L=(0,window.lunr)((function(){this.field("name"),this.field("address"),this.field("strSocket"),this.field("quietAways"),this.field("wifiGood")})),T=_.map(e=>e.coffeeShops?e:Object(S.a)({},e,{coffeeShops:[]})),G=function(){var e=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.get("".concat("/coffee-map","/cafedata/").concat(t.name,".json"));case 2:if(!(a=e.sent).data){e.next=8;break}return a.data.forEach(e=>{L.add(Object(S.a)({},e,{strSocket:e&&"yes"===e.socket?"\u63d2\u5ea7":"",quietAways:e&&e.quiet>3?"\u5b89\u975c":"",wifiGood:e&&e.wifi>3?"\u7db2\u8def":""}))}),t.coffeeShops=a.data,t.checked=!0,e.abrupt("return",t);case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function I(){return(I=Object(d.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((e,t)=>{if(e&&!T[t].coffeeShops.length){return G(T[t])}return e||(T[t].checked=!1),e&&(T[t].checked=!0),T[t]}));case 2:return a=e.sent,n=[],a.forEach(e=>{e.checked&&(n=n.concat(e.coffeeShops))}),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(d.a)(m.a.mark((function e(t){var a,n,c,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],""===t.toString().trim()){e.next=7;break}return console.log(t),e.next=5,L.search(t);case 5:(n=e.sent)&&n.length&&(c=n.map(e=>e.ref),l=[],T.filter(e=>e.checked).forEach(e=>{l=l.concat(e.coffeeShops)}),l=l.filter(e=>-1!==c.indexOf(e.id)),a=l);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P={getCoffee:function(e){return I.apply(this,arguments)},searchWithKeyWord:function(e){return F.apply(this,arguments)}};var D=function({onChange:e,onHover:t,checkedConditions:a,nowItem:l,toggleCondition:r}){let o="";const i=Object(n.useRef)(null),s=Object(n.useState)(1),u=Object(p.a)(s,2),h=u[0],f=u[1],g=Object(n.useState)([]),E=Object(p.a)(g,2),b=E[0],y=E[1],k=Object(n.useState)([]),O=Object(p.a)(k,2),v=O[0],w=O[1],N=Object(n.useState)(""),_=Object(p.a)(N,2),j=_[0],S=_[1],x=C.filter((e,t)=>a[t]).map(e=>e.displayName).join(" "),M=Object(n.useCallback)(function(){var e=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),e.next=3,P.searchWithKeyWord("".concat(x," ").concat(j));case 3:a=e.sent,y(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[x,j]);function L(e){e&&l&&e.id!==l.id&&(t(e),i.current.blur())}Object(n.useEffect)(()=>{""===j&&M()},[j,M]),Object(n.useEffect)(()=>{""!==x&&M()},[x,M]),Object(n.useEffect)(()=>{b.length&&w(b.slice(0,10*h))},[b,h]),v.length&&(o=v.map(e=>c.a.createElement("div",{role:"presentation",key:e.id,className:"card",onClick:()=>{L(e),i.current.blur()},onFocus:()=>{L(e)},onTouchMove:()=>{L(e)}},c.a.createElement("h4",null,e.name),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("ol",null,"no"===e.limited_time?c.a.createElement("li",null,"\u7121\u9650\u6642"):"",""!==e.socket||"no"!==e.socket?c.a.createElement("li",null,"\u63d2\u5ea7"):"",e.wifi>3?c.a.createElement("li",null,"WIFI"):"",e.quiet>3?c.a.createElement("li",null,"\u8f03\u5b89\u975c"):"",e.cheap>3?c.a.createElement("li",null,"\u8f03\u4fbf\u5b9c"):"")),c.a.createElement("li",null,"\u5730\u5740:".concat(e.address)),e.open_time?c.a.createElement("li",null,"\u71df\u696d\u6642\u9593: ".concat(e.open_time)):"",c.a.createElement("li",null,c.a.createElement("a",{href:e.url},"\u7c89\u7d72\u5c08\u9801"))))));let T="\u8f38\u5165\u5e97\u540d \u5730\u5740";x&&(T="\u67e5\u8a62\u689d\u4ef6:".concat(x));let G=c.a.createElement("button",{type:"submit",className:"btn search__button",onClick:M},c.a.createElement("svg",{viewBox:"0 0 100 100"},c.a.createElement("circle",{id:"circle",cx:"45",cy:"45",r:"30"}),c.a.createElement("path",{id:"line",d:"M45,45 L100,100"})));return""===j&&""===x||(G=c.a.createElement("button",{type:"button",className:"btn search__button",onClick:function(){r(),S(""),w([])}},c.a.createElement("span",null,"\u2715"))),c.a.createElement("form",{onSubmit:M},c.a.createElement("input",{value:j,onChange:function(e){S(e.target.value)},ref:i,onClick:()=>{M()},onKeyPress:function(e){"Enter"===e.key&&i.current.blur()},placeholder:"".concat(T)}),c.a.createElement("div",{className:"search__result",onScroll:function(e){e.target.scrollTop>e.target.clientHeight*h&&b.length>10*h&&f(h+1)}},o),G)};function q({isMenuOpen:e,checkedCities:t,checkedConditions:a,toggleMenu:l,toggleCondition:r}){const o=Object(n.useState)({name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"}),i=Object(p.a)(o,2),s=i[0],u=i[1],h=Object(n.useState)({lng:121.5598,lat:25.08}),f=Object(p.a)(h,2),g=f[0],E=f[1],b=Object(n.useState)([]),y=Object(p.a)(b,2),k=y[0],O=y[1],N=Object(n.useState)(!0),_=Object(p.a)(N,2),C=_[0],S=_[1],x=s;let M=k;const L=e?"menu-open":"";let T="";function G(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}function I(){return(I=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),console.log("loading"),e.next=4,P.getCoffee(t);case 4:a=e.sent,console.log("loading done"),S(!1),O(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)(()=>{!function(e){I.apply(this,arguments)}(t)},[t]),M=0===k.length?[{lat:24.8,lng:121.023,popup:"<div><span>\u76ee\u524d\u5c1a\u672a\u9078\u64c7\u4efb\u4f55\u5730\u9ede<br/>\u8acb\u6309\u5de6\u65b9\u529f\u80fd\u9375\u9032\u5165\u9078\u55ae\u9078\u64c7XD<br/></span></div>"}]:k.map(e=>{const t=e.latitude,a=e.longitude,n=e.name,c=e.address,l=e.wifi,r=e.seat,o=e.quiet,i=e.tasty,u=e.cheap,m=e.music;return{lat:parseFloat(t),lng:parseFloat(a),popup:"<div>\n            <span style=".concat({fontWeight:800,fontSize:"16px"},">").concat(n,"</span><br /> \n            <span>\n            ").concat(c,"<br />\n            ").concat(l>0?"WIFI\u7a69\u5b9a: ".concat(G(l)):""," ").concat(l>0?"<br />":"","\n            ").concat(r>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(G(r)):""," ").concat(r>0?"<br />":"","\n            ").concat(o>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(G(o)):""," ").concat(o>0?"<br />":"","\n            ").concat(i>0?"\u5496\u5561\u597d\u559d:  ".concat(G(i)):""," ").concat(i>0?"<br />":"","\n            ").concat(u>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(G(u)):""," ").concat(u>0?"<br />":"","\n            ").concat(m>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(G(m)):""," ").concat(m>0?"<br />":"","\n            </span>\n            ").concat(s.url?"<a href=".concat(s.url,">\u7c89\u7d72\u5c08\u9801</a>"):"","\n          </div>")}}),C&&(T=c.a.createElement("div",{className:"loading__overlay"},c.a.createElement("div",{className:"loading__content"},c.a.createElement("div",{className:"loader"},"Loading...")))),c.a.createElement("div",{className:"app"},T,c.a.createElement("div",{className:L},c.a.createElement("div",{className:"search-container"},c.a.createElement(D,{nowItem:s,toggleCondition:r,checkedConditions:a,onChange:function(e){s&&e&&s.id!==e.id&&u(e),r()},onHover:function(e){s&&e&&s.id!==e.id&&u(e)}})),c.a.createElement(j,{toggleMenu:l,setPosition:E}),c.a.createElement(w,{toggleMenu:l})),c.a.createElement(v,{position:g,item:x,items:M,isMenuOpen:e,toggleMenu:l}))}q.defaultProps={name:"Gary"};var W=Object(o.b)((function(e){return{isMenuOpen:e.isMenuOpen,checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}),e=>({toggleCondition:()=>e(N()),toggleMenu:()=>e({type:"TOGGLE_MENU"})}))(q);a(83);var A=(e=!1,t)=>{switch(t.type){case"TOGGLE_MENU":return!e;default:return e}};var H=(e={name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"},t)=>{switch(t.type){case"SELECT_PLACE":return{name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~1",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"};default:return e}};var z=(e=[],t)=>{switch(t.type){case"ALL_PLACE":return[...e];default:return e}};const K=_.map(e=>e.checked);var U=(e=K,t)=>{switch(t.type){case"TOGGLE_CHECK":return[...t.payload];default:return e}};const X=C.map(e=>e.checked);var B=(e=X,t)=>{switch(t.type){case"TOGGLE_CONDITION":return t.payload?[...t.payload]:X;default:return e}};var R=Object(r.b)({checkedCities:U,checkedConditions:B,isMenuOpen:A,item:H,items:z});Object(i.createLogger)();const J=[s.a],V=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):r.c)(Object(r.a)(...J)),Z=Object(r.d)(R,V);Object(l.render)(c.a.createElement(o.a,{store:Z},c.a.createElement(W,null)),document.getElementById("root"));var Q,Y,$,ee,te,ae;if("linyencheng.github.io"===window.location.host&&(Q=window,Y=document,$="script",ee="ga",Q.GoogleAnalyticsObject=ee,Q.ga=Q.ga||function(){(Q.ga.q=Q.ga.q||[]).push(arguments)},Q.ga.l=1*new Date,te=Y.createElement($),ae=Y.getElementsByTagName($)[0],te.async=1,te.src="//www.google-analytics.com/analytics.js",ae.parentNode.insertBefore(te,ae),window.ga)){const e=window.ga;e("create","UA-106834789-1","linyencheng.github.io"),e("send","pageview")}}},[[46,1,2]]]);
//# sourceMappingURL=main.4d886888.chunk.js.map