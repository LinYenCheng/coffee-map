(this["webpackJsonpreact-leaflet-map"]=this["webpackJsonpreact-leaflet-map"]||[]).push([[0],{56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(16),i=n(21),r=n(18),o=n(41),s=n(44),l=n(13),u=n(3),d=n(6),j=n.n(d),h=n(81),p=n(82),b=n(83),f=n(84),O=n(85),m=n(42),g=n.n(m),x=n(1);function v(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}var y=function(e){var t=e.position,n=e.item,a=e.isActive,i=e.map,r=n.url,o=n.name,s=n.address,l=n.wifi,d=n.seat,j=n.quiet,b=n.tasty,f=n.cheap,O=n.music,m=Object(c.useState)(!1),g=Object(u.a)(m,2),y=g[0],k=g[1],N=Object(c.useRef)();return Object(c.useEffect)((function(){y&&a&&(N.openOn(i),i.panTo({lat:t[0],lng:t[1]}))}),[a,y,i,t]),a?Object(x.jsx)(h.a,{position:{lat:t[0],lng:t[1]},children:Object(x.jsx)(p.a,{ref:function(e){N=e,k(!0)},children:Object(x.jsxs)("div",{children:[Object(x.jsx)("span",{style:{fontWeight:800,fontSize:"16px"},children:o}),Object(x.jsx)("br",{}),Object(x.jsxs)("span",{children:[s,Object(x.jsx)("br",{}),l>0?"WIFI\u7a69\u5b9a: ".concat(v(l)," "):" ",l>0?Object(x.jsx)("br",{}):"",d>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(v(d)," "):" ",d>0?Object(x.jsx)("br",{}):"",j>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(v(j)," "):" ",j>0?Object(x.jsx)("br",{}):"",b>0?"\u5496\u5561\u597d\u559d:  ".concat(v(b)," "):" ",b>0?Object(x.jsx)("br",{}):"",f>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(v(f)," "):" ",f>0?Object(x.jsx)("br",{}):"",O>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(v(O)," "):" ",O>0?Object(x.jsx)("br",{}):""]}),r?Object(x.jsx)("a",{href:r,children:"\u7c89\u7d72\u5c08\u9801"}):""]})})}):null};function k(e){var t=e.isMenuOpen,n=e.toggleMenu;Object(b.a)("click",(function(){t&&n()}));return null}var N=function(e){var t=e.position,n=e.isMenuOpen,a=e.toggleMenu,i=e.item,r=e.items,o=Object(c.useState)(),s=Object(u.a)(o,2),l=s[0],d=s[1],j=i.latitude,b=i.longitude,m=[parseFloat(j),parseFloat(b)],v=r.filter((function(e){return e.lat})).map((function(e,t){return Object(x.jsx)(h.a,{opacity:.6,position:[parseFloat(e.lat),parseFloat(e.lng)],children:Object(x.jsx)(p.a,{children:Object(x.jsx)("div",{dangerouslySetInnerHTML:{__html:e.popup}})})},"".concat(e.lat).concat(e.lng).concat(t))}));return Object(x.jsxs)(f.a,{center:t,zoom:12,maxZoom:18,zoomControl:!1,animate:!0,whenCreated:d,children:[Object(x.jsx)(k,{isMenuOpen:n,toggleMenu:a}),Object(x.jsx)(O.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(x.jsx)(y,{position:m,map:l,data:{position:[20.27,-156]},item:i,isActive:j&&i.name}),Object(x.jsx)(g.a,{children:v})]})},_=(n(56),function(e){var t=e.toggleMenu;return Object(x.jsx)("button",{type:"button",id:"menu-button",onClick:function(e){var n=t;e.preventDefault(),n()},children:Object(x.jsx)("div",{className:"hamburger",children:Object(x.jsx)("div",{className:"inner"})})})}),C=(n(57),function(e){return{type:"TOGGLE_CONDITION",payload:e}}),w=[{name:"taipei",displayName:"\u53f0\u5317",lng:121.5598,lat:25.08,checked:!0},{name:"keelung",displayName:"\u57fa\u9686",lng:121.7081,lat:25.10898,checked:!1},{name:"taoyuan",displayName:"\u6843\u5712",lng:121.300974,lat:24.993312,checked:!1},{name:"hsinchu",displayName:"\u65b0\u7af9",lng:120.9647,lat:24.80395,checked:!1},{name:"miaoli",displayName:"\u82d7\u6817",lng:120.820793,lat:24.565031,checked:!1},{name:"taichung",displayName:"\u53f0\u4e2d",lng:120.645756,lat:24.176912,checked:!1},{name:"changhua",displayName:"\u5f70\u5316",lng:120.4818,lat:23.99297,checked:!1},{name:"nantou",displayName:"\u5357\u6295",lng:120.9876,lat:23.83876,checked:!1},{name:"yunlin",displayName:"\u96f2\u6797",lng:120.3897,lat:23.75585,checked:!1},{name:"chiayi",displayName:"\u5609\u7fa9",lng:120.574,lat:23.45889,checked:!1},{name:"tainan",displayName:"\u53f0\u5357",lng:120.1851,lat:23.005181,checked:!1},{name:"kaohsiung",displayName:"\u9ad8\u96c4",lng:120.312019,lat:22.623045,checked:!1},{name:"pingtung",displayName:"\u5c4f\u6771",lng:120.62,lat:22.54951,checked:!1},{name:"yilan",displayName:"\u5b9c\u862d",lng:121.7195,lat:24.69295,checked:!1},{name:"hualien",displayName:"\u82b1\u84ee",lng:121.3542,lat:23.7569,checked:!1},{name:"taitung",displayName:"\u53f0\u6771",lng:120.9876,lat:22.98461,checked:!1},{name:"penghu",displayName:"\u6f8e\u6e56",lng:119.6151,lat:23.56548,checked:!1}],E=[{name:"socket",displayName:"\u63d2\u5ea7",checked:!1},{name:"quiet",displayName:"\u5b89\u975c",checked:!1},{name:"wifi",displayName:"\u7db2\u8def",checked:!1}];var S=Object(r.b)((function(e){return{checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}))((function(e){var t=e.setPosition,n=e.checkedCities,c=e.checkedConditions,a=e.dispatch,i=e.toggleMenu,r=w.map((function(e,c){return Object(x.jsxs)("li",{className:"nav__li",children:[Object(x.jsx)("input",{id:e.name,type:"checkbox",checked:n[c],onChange:function(){var r=n.slice();r[c]=!n[c],n[c]||t([e.lat,e.lng]),a(function(e){return{type:"TOGGLE_CHECK",payload:e}}(r)),i()}}),Object(x.jsx)("label",{htmlFor:e.name,className:"nav__label",children:e.displayName})]},e.name)})),o=E.map((function(e,t){return Object(x.jsxs)("li",{className:"nav__li",children:[Object(x.jsx)("input",{id:e.name,type:"checkbox",checked:c[t],onChange:function(){var e=c.slice();e[t]=!c[t],a(C(e)),i()}}),Object(x.jsx)("label",{htmlFor:e.name,className:"nav__label nav__label--condition",children:e.displayName})]},e.name)}));return Object(x.jsx)("nav",{children:Object(x.jsxs)("ul",{children:[o,Object(x.jsx)("br",{}),r]})})})),M=(n(58),n(7)),L=n(43),T=n.n(L),I=(0,window.lunr)((function(){this.field("name"),this.field("address"),this.field("strSocket"),this.field("quietAways"),this.field("wifiGood")})),G=w.map((function(e){return e.coffeeShops?e:Object(M.a)(Object(M.a)({},e),{},{coffeeShops:[]})})),F=function(){var e=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.get("".concat("/coffee-map","/cafedata/").concat(t.name,".json"));case 2:if(!(n=e.sent).data){e.next=8;break}return n.data.forEach((function(e){I.add(Object(M.a)(Object(M.a)({},e),{},{strSocket:e&&"yes"===e.socket?"\u63d2\u5ea7":"",quietAways:e&&e.quiet>3?"\u5b89\u975c":"",wifiGood:e&&e.wifi>3?"\u7db2\u8def":""}))})),t.coffeeShops=n.data,t.checked=!0,e.abrupt("return",t);case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function D(){return(D=Object(l.a)(j.a.mark((function e(t){var n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e,t){return e&&!G[t].coffeeShops.length?F(G[t]):(e||(G[t].checked=!1),e&&(G[t].checked=!0),G[t])})));case 2:return n=e.sent,c=[],n.forEach((function(e){e.checked&&(c=c.concat(e.coffeeShops))})),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(l.a)(j.a.mark((function e(t){var n,c,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],""===t.toString().trim()){e.next=6;break}return e.next=4,I.search(t);case 4:(c=e.sent)&&c.length&&(a=c.map((function(e){return e.ref})),i=[],G.filter((function(e){return e.checked})).forEach((function(e){i=i.concat(e.coffeeShops)})),i=i.filter((function(e){return-1!==a.indexOf(e.id)})),n=i);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W={getCoffee:function(e){return D.apply(this,arguments)},searchWithKeyWord:function(e){return P.apply(this,arguments)}},q=W;var A=function(e){var t=e.onHover,n=e.checkedConditions,a=e.nowItem,i=e.toggleCondition,r="",o=Object(c.useRef)(null),s=Object(c.useState)(1),d=Object(u.a)(s,2),h=d[0],p=d[1],b=Object(c.useState)([]),f=Object(u.a)(b,2),O=f[0],m=f[1],g=Object(c.useState)([]),v=Object(u.a)(g,2),y=v[0],k=v[1],N=Object(c.useState)(""),_=Object(u.a)(N,2),C=_[0],w=_[1],S=E.filter((function(e,t){return n[t]})).map((function(e){return e.displayName})).join(" "),M=Object(c.useCallback)(function(){var e=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),e.next=3,q.searchWithKeyWord("".concat(S," ").concat(C));case 3:n=e.sent,m(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[S,C]);function L(e){e&&a&&e.id!==a.id&&(t(e),o.current.blur())}Object(c.useEffect)((function(){""===C&&M()}),[C,M]),Object(c.useEffect)((function(){""!==S&&M()}),[S,M]),Object(c.useEffect)((function(){O.length&&k(O.slice(0,10*h))}),[O,h]),y.length&&(r=y.map((function(e){return Object(x.jsxs)("div",{role:"presentation",className:"card",onClick:function(){L(e),o.current.blur()},onFocus:function(){L(e)},onTouchMove:function(){L(e)},children:[Object(x.jsx)("h4",{children:e.name}),Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{children:Object(x.jsxs)("ol",{children:["no"===e.limited_time?Object(x.jsx)("li",{children:"\u7121\u9650\u6642"}):"",""!==e.socket||"no"!==e.socket?Object(x.jsx)("li",{children:"\u63d2\u5ea7"}):"",e.wifi>3?Object(x.jsx)("li",{children:"WIFI"}):"",e.quiet>3?Object(x.jsx)("li",{children:"\u8f03\u5b89\u975c"}):"",e.cheap>3?Object(x.jsx)("li",{children:"\u8f03\u4fbf\u5b9c"}):""]})}),Object(x.jsx)("li",{children:"\u5730\u5740:".concat(e.address)}),e.open_time?Object(x.jsx)("li",{children:"\u71df\u696d\u6642\u9593: ".concat(e.open_time)}):"",Object(x.jsx)("li",{children:Object(x.jsx)("a",{href:e.url,children:"\u7c89\u7d72\u5c08\u9801"})})]})]},e.id)})));var T="\u8f38\u5165\u5e97\u540d \u5730\u5740";S&&(T="\u67e5\u8a62\u689d\u4ef6:".concat(S));var I=Object(x.jsx)("button",{type:"submit",className:"btn search__button",onClick:M,children:Object(x.jsxs)("svg",{viewBox:"0 0 100 100",children:[Object(x.jsx)("circle",{id:"circle",cx:"45",cy:"45",r:"30"}),Object(x.jsx)("path",{id:"line",d:"M45,45 L100,100"})]})});return""===C&&""===S||(I=Object(x.jsx)("button",{type:"button",className:"btn search__button",onClick:function(){i(),w(""),k([])},children:Object(x.jsx)("span",{children:"\u2715"})})),Object(x.jsxs)("form",{onSubmit:M,children:[Object(x.jsx)("input",{value:C,onChange:function(e){w(e.target.value)},ref:o,onClick:function(){M()},onKeyPress:function(e){"Enter"===e.key&&o.current.blur()},placeholder:"".concat(T)}),Object(x.jsx)("div",{className:"search__result",onScroll:function(e){e.target.scrollTop>e.target.clientHeight*h&&O.length>10*h&&p(h+1)},children:r}),I]})};function H(e){var t=e.isMenuOpen,n=e.checkedCities,a=e.checkedConditions,i=e.toggleMenu,r=e.toggleCondition,o=Object(c.useState)({name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"}),s=Object(u.a)(o,2),d=s[0],h=s[1],p=Object(c.useState)({lng:121.5598,lat:25.08}),b=Object(u.a)(p,2),f=b[0],O=b[1],m=Object(c.useState)([]),g=Object(u.a)(m,2),v=g[0],y=g[1],k=Object(c.useState)(!0),C=Object(u.a)(k,2),w=C[0],E=C[1],M=d,L=v,T=t?"menu-open":"",I="";function G(e){switch(e){case 5:return"\u2605\u2605\u2605\u2605\u2605";case 4:return"\u2605\u2605\u2605\u2605";case 3:return"\u2605\u2605\u2605";case 2:return"\u2605\u2605";default:return"\u2605"}}function F(){return(F=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(!0),e.next=3,q.getCoffee(t);case 3:n=e.sent,E(!1),y(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){!function(e){F.apply(this,arguments)}(n)}),[n]),L=0===v.length?[{lat:24.8,lng:121.023,popup:"<div><span>\u76ee\u524d\u5c1a\u672a\u9078\u64c7\u4efb\u4f55\u5730\u9ede<br/>\u8acb\u6309\u5de6\u65b9\u529f\u80fd\u9375\u9032\u5165\u9078\u55ae\u9078\u64c7XD<br/></span></div>"}]:v.map((function(e){var t=e.latitude,n=e.longitude,c=e.name,a=e.address,i=e.wifi,r=e.seat,o=e.quiet,s=e.tasty,l=e.cheap,u=e.music;return{lat:parseFloat(t),lng:parseFloat(n),popup:"<div>\n            <span style=".concat({fontWeight:800,fontSize:"16px"},">").concat(c,"</span><br /> \n            <span>\n            ").concat(a,"<br />\n            ").concat(i>0?"WIFI\u7a69\u5b9a: ".concat(G(i)):""," ").concat(i>0?"<br />":"","\n            ").concat(r>0?"\u901a\u5e38\u6709\u4f4d:  ".concat(G(r)):""," ").concat(r>0?"<br />":"","\n            ").concat(o>0?"\u5b89\u975c\u7a0b\u5ea6:  ".concat(G(o)):""," ").concat(o>0?"<br />":"","\n            ").concat(s>0?"\u5496\u5561\u597d\u559d:  ".concat(G(s)):""," ").concat(s>0?"<br />":"","\n            ").concat(l>0?"\u50f9\u683c\u4fbf\u5b9c:  ".concat(G(l)):""," ").concat(l>0?"<br />":"","\n            ").concat(u>0?"\u88dd\u6f62\u97f3\u6a02:  ".concat(G(u)):""," ").concat(u>0?"<br />":"","\n            </span>\n            ").concat(d.url?"<a href=".concat(d.url,">\u7c89\u7d72\u5c08\u9801</a>"):"","\n          </div>")}})),w&&(I=Object(x.jsx)("div",{className:"loading__overlay",children:Object(x.jsx)("div",{className:"loading__content",children:Object(x.jsx)("div",{className:"loader",children:"Loading..."})})})),Object(x.jsxs)("div",{className:"app",children:[I,Object(x.jsxs)("div",{className:T,children:[Object(x.jsx)("div",{className:"search-container",children:Object(x.jsx)(A,{nowItem:d,toggleCondition:r,checkedConditions:a,onChange:function(e){d&&e&&d.id!==e.id&&h(e),r()},onHover:function(e){d&&e&&d.id!==e.id&&h(e)}})}),Object(x.jsx)(S,{toggleMenu:i,setPosition:O}),Object(x.jsx)(_,{toggleMenu:i})]}),Object(x.jsx)(N,{position:f,item:M,items:L,isMenuOpen:t,toggleMenu:i})]})}H.defaultProps={name:"Gary"};var z=Object(r.b)((function(e){return{isMenuOpen:e.isMenuOpen,checkedCities:e.checkedCities,checkedConditions:e.checkedConditions}}),(function(e){return{toggleCondition:function(){return e(C())},toggleMenu:function(){return e({type:"TOGGLE_MENU"})}}}))(H),K=(n(77),function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"TOGGLE_MENU"===t.type?!e:e}),X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"},t=arguments.length>1?arguments[1]:void 0;return"SELECT_PLACE"===t.type?{name:"\u641c\u5c0b\u60f3\u53bb\u7684\u5496\u5561\u5e97~1",address:"\u986f\u793a\u5730\u5740\u53ca\u7c89\u5c08"}:e},R=n(19),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"ALL_PLACE"===t.type?Object(R.a)(e):e},B=w.map((function(e){return e.checked})),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;if("TOGGLE_CHECK"===t.type){var n=Object(R.a)(t.payload);return n}return e},V=E.map((function(e){return e.checked})),Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;if("TOGGLE_CONDITION"===t.type){var n=t.payload?Object(R.a)(t.payload):V;return n}return e},Q=Object(i.b)({checkedCities:J,checkedConditions:Z,isMenuOpen:K,item:X,items:U});window.process||(window.process={});Object(o.createLogger)();var Y=[s.a],$=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):i.c)(i.a.apply(void 0,Y)),ee=Object(i.d)(Q,$);Object(a.render)(Object(x.jsx)(r.a,{store:ee,children:Object(x.jsx)(z,{})}),document.getElementById("root"))}},[[78,1,2]]]);
//# sourceMappingURL=main.e0239fae.chunk.js.map